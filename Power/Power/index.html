<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>上海恒劲动力科技有限公司 - 主页</title>

    <link rel="shortcut icon" href="../favicon.ico" />
    <link href="js/lib/ligerUI/skins/ligerui-icons.css" rel="stylesheet" type="text/css">
    <link href="css/plugins/sweetalert/sweetalert.css" rel="stylesheet" />
    <link href="css/plugins/dataTables/dataTables.bootstrap.css" rel="stylesheet" />
    <link href="js/lib/ligerUI/skins/Aqua/css/ligerui-all.css" rel="stylesheet" type="text/css" />
    <link href="js/lib/ligerUI/skins/Gray/css/all.css" rel="stylesheet" type="text/css" />
    <link href="css/bootstrap.min14ed.css" rel="stylesheet">
    <link href="css/font-awesome.min93e3.css" rel="stylesheet">
    <link href="css/animate.min.css" rel="stylesheet">
    <link href="css/common.css" rel="stylesheet">


    <script src="js/jquery.min.js?v=2.1.4"></script>
    <script src="js/lib/ligerUI/js/core/base.js" type="text/javascript"></script>
    <script src="js/jquery/ligerUI/ligerui.all.js"></script>
    <script src="js/plugins/layer/layer.min.js"></script>
    <script src="js/lib/ligerUI/js/plugins/ligerTab.js"></script>
    <script src="js/lib/jquery.cookie.js"></script>   
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/hplus.min.js?v=4.1.0"></script>
    <script type="text/javascript" src="js/contabs.min.js"></script>
    <script src="js/plugins/pace/pace.min.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
    <script src="js/bootstrap.min.js?v=3.3.6"></script>
   
    <script src="js/plugins/sweetalert/sweetalert.min.js"></script>

    <script type="text/javascript">
        window.onerror = function () { return true; }
            var tab = null;
            var accordion = null;
            
            $(function () {
              
                $.ajax({
                    type: "GET",
                    url: "/api/Sys_User/GetLoginInfo",
                    dataType: "json",
                    success: function (result) {
                        if (result != "") {
                            var user = eval("(" + result + ")");
                            $("#lblUsername").html(user.Company + " " + user.UserName);
                            layout();

                        }
                        else {
                            location.href = "login.html";
                        }
                    },
                    error: function (error) {

                    }
                });
            });
            function Extes() {
                $.ajax({
                    type: "GET",
                    url: "/api/Current/GetLogoutInfo",
                    dataType: "json",
                    success: function (result) {
                        if (result != "") {
                           
                            location.href = "login.html";

                        }
                        else {
                            location.href = "login.html";
                        }
                    },
                    error: function (error) {

                    }
                });
              
            }
            function layout()
            {

                //布局
                $("#layout1").ligerLayout({ leftWidth: 222, height: '100%',heightDiff:-34,space:4, onHeightChanged: f_heightChanged });

                var height = $(".l-layout-center").height();

                //Tab
                $("#framecenter").ligerTab({
                    height: height,
                    showSwitchInTab : true,
                    showSwitch: true,
                    onReload: function (tabdata)
                    {
                        var tabid = tabdata.tabid;
                        addFrameSkinLink(tabid);
                    }
                });

                //面板
                $("#accordion1").ligerAccordion({
                    height: height - 24, speed: null
                });
                   

                tab = liger.get("framecenter");
                accordion = liger.get("accordion1");
                $("#pageloading").hide();

                pages_init();
                menu();
                bb();
                $("#home").attr("src", "Device/Map.html");
            }

            function f_heightChanged(options)
            {
                if (tab)
                    tab.addHeight(options.diff);
                if (accordion && options.middleHeight - 24 > 0)
                    accordion.setHeight(options.middleHeight - 24);
            }
            function f_addTab(tabid, text, url)
            {
                tab.addTabItem({
                    tabid: tabid,
                    text: text,
                    url: url,
                    callback: function ()
                    {                      
                        addFrameSkinLink(tabid);
                    }
                });
            }
           
         
            function addFrameSkinLink(tabid)
            {
                var prevHref = getLinkPrevHref(tabid) || "";
                var skin = getQueryString("skin");
                if (!skin) return;
                skin = skin.toLowerCase();
                attachLinkToFrame(tabid, prevHref + skin_links[skin]);
            }
          
            function pages_init()
            {
                var tabJson = $.cookie('liger-home-tab');
                if (tabJson)
                {
                    var tabitems = JSON2.parse(tabJson);
                    for (var i = 0; tabitems && tabitems[i];i++)
                    {
                        f_addTab(tabitems[i].tabid, tabitems[i].text, tabitems[i].url);
                    }
                }
            }
            function saveTabStatus()
            {
                $.cookie('liger-home-tab', JSON2.stringify(tabItems));
            }
     
            function getQueryString(name)
            {
                var now_url = document.location.search.slice(1), q_array = now_url.split('&');
                for (var i = 0; i < q_array.length; i++)
                {
                    var v_array = q_array[i].split('=');
                    if (v_array[0] == name)
                    {
                        return v_array[1];
                    }
                }
                return false;
            }
            function attachLinkToFrame(iframeId, filename)
            {
                if(!window.frames[iframeId]) return;
                var head = window.frames[iframeId].document.getElementsByTagName('head').item(0);
                var fileref = window.frames[iframeId].document.createElement("link");
                if (!fileref) return;
                fileref.setAttribute("rel", "stylesheet");
                fileref.setAttribute("type", "text/css");
                fileref.setAttribute("href", filename);
                head.appendChild(fileref);
            }
            function getLinkPrevHref(iframeId)
            {
                if (!window.frames[iframeId]) return;
                var head = window.frames[iframeId].document.getElementsByTagName('head').item(0);
                var links = $("link:first", head);
                for (var i = 0; links[i]; i++)
                {
                    var href = $(links[i]).attr("href");
                    if (href && href.toLowerCase().indexOf("ligerui") > 0)
                    {
                        return href.substring(0, href.toLowerCase().indexOf("lib") );
                    }
                }
            }

            function menu() {

                $.ajax({
                    type: "POST",
                    url: "/api/MenuInfo/BindMenuInfo",
                    dataType: "json",
                    success: function (result) {

                        $("#accordion1").html(result);
                        bb();
                    },
                    error: function (error) {

                    }
                });
            }
    </script>

    <style type="text/css">
        body, html {
            height: 100%;
        }


        .l-layout-bottom {
            background: #E5EDEF;
            text-align: center;
        }

        #pageloading {
            position: absolute;
            left: 0px;
            top: 0px;
            background: white url('loading.gif') no-repeat center;
            width: 100%;
            height: 100%;
            z-index: 99999;
        }

        .l-link {
            display: block;
            line-height: 20px;
            height: 35px;
            padding-left: 15px;
            margin: 2px;           
        }

        .l-link-over {
            background: #ffcd00;
            border: 1px solid #DB9F00;
        }

        .space {
            color: #E7E7E7;
        }
      



      
    </style>
</head>
<body class="fixed-sidebar full-height-layout gray-bg" style="overflow:hidden">
    <div id="pageloading"></div>
    <div id="topmenu">
        <div style="height:80px; background:url(images/logo_bg.jpg); position:relative;">
            <div style="padding: 35px 50px 0px 0px; color: #fff; float: right;">
                <a href="#" class="btn btn-success btn-rounded" onclick="javascript: if (confirm('确认退出吗？')) { Extes(); }">退出</a>
            </div>
            <div style="padding:50px 30px 0px 0px; color:#fff; float:right;">欢迎登陆，<label id="lblUsername"></label>
</div>
            <img style="float:left;" src="images/logo.jpg">
            </div>
    </div>
    <div id="layout1" style="width:99.2%; margin:0 auto; margin-top:4px; ">

        <div position="left" title="系统菜单" id="accordion1" class="navbar-default navbar-static-side zybor_r ">
           
        </div>

        <div position="center" id="framecenter">
            <div tabid="home" title="我的主页" style="height:300px">
                <iframe frameborder="0" name="home" id="home" src=""></iframe>
            </div>
        </div>

    </div>
    <div style="height:32px; line-height:32px; text-align:center;">
        Copyright © 2009-2017
    </div>
    <div style="display:none">
      
    </div>
</body>
</html>
